<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>D:\Projects\Hermes\repo\iml-generators\com.utc.utrc.hermes.iml.gen.docs\html\.gen_smt_output.md.html</title>


<style type="text/css">
body {
	color: #333;
	font: 13px/1.4 "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
	padding: 0;
	margin: 0;
}

a {
	background: transparent;
	color: #4183c4;
	text-decoration: none;
}

a:active,
a:hover {
	outline: 0 none;
	text-decoration: underline;
}

abbr[title] {
	border-bottom: 1px dotted;
}

b,
strong {
	font-weight: bold;
}

dfn {
	font-style: italic;
}
h1 {
	font-size: 2em;
	margin: 0.67em 0;
}
mark {
	background: #ff0;
	color: #000;
}
small {
	font-size: 80%;
}
sub, sup {
	font-size: 75%;
	line-height: 0;
	position: relative;
	vertical-align: baseline;
}
sup {
	top: -0.5em;
}
sub {
	bottom: -0.25em;
}
img {
	border: 0 none;
}
svg:not(:root) {
	overflow: hidden;
}
figure {
	margin: 1em 40px;
}
hr {
	box-sizing: content-box;
	height: 0;
}

code,
kbd,
pre,
samp {
	font-family: monospace,monospace;
	font-size: 1em;
}

pre {
	overflow: auto;
	font: 12px Consolas,"Liberation Mono",Menlo,Courier,monospace;
	margin-bottom: 0;
	margin-top: 0;
}

.markdown-body {
	padding: 30px;
	font-size: 16px;
	line-height: 1.6;
	word-wrap: break-word;
}

.markdown-body>*:first-child {
	margin-top: 0 !important;
}

.markdown-body>*:last-child {
	margin-bottom: 0 !important;
}

.markdown-body .absent {
	color: #c00;
}

.markdown-body .anchor {
	position: absolute;
	top: 0;
	bottom: 0;
	left: 0;
	display: block;
	padding-right: 6px;
	padding-left: 30px;
	margin-left: -30px;
}

.markdown-body .anchor:focus {
	outline: none;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
	position: relative;
	margin-top: 1em;
	margin-bottom: 16px;
	font-weight: bold;
	line-height: 1.4;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
	display: none;
	color: #000;
	vertical-align: middle;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
	padding-left: 8px;
	margin-left: -30px;
	line-height: 1;
	text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
	display: inline-block;
}

.markdown-body h1 tt,
.markdown-body h1 code,
.markdown-body h2 tt,
.markdown-body h2 code,
.markdown-body h3 tt,
.markdown-body h3 code,
.markdown-body h4 tt,
.markdown-body h4 code,
.markdown-body h5 tt,
.markdown-body h5 code,
.markdown-body h6 tt,
.markdown-body h6 code {
	font-size: inherit;
}

.markdown-body h1 {
	padding-bottom: 0.3em;
	font-size: 2.25em;
	line-height: 1.2;
	border-bottom: 1px solid #eee;
}

.markdown-body h2 {
	padding-bottom: 0.3em;
	font-size: 1.75em;
	line-height: 1.225;
	border-bottom: 1px solid #eee;
}

.markdown-body h3 {
	font-size: 1.5em;
	line-height: 1.43;
}

.markdown-body h4 {
	font-size: 1.25em;
}

.markdown-body h5 {
	font-size: 1em;
}

.markdown-body h6 {
	font-size: 1em;
	color: #777;
}

.markdown-body p,.markdown-body blockquote,
.markdown-body ul,.markdown-body ol,
.markdown-body dl,.markdown-body table,
.markdown-body pre {
	margin-top: 0;
	margin-bottom: 16px;
}

.markdown-body hr {
	height: 4px;
	padding: 0;
	margin: 16px 0;
	background-color: #e7e7e7;
	border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
	padding-left: 2em;
}

.markdown-body ul.no-list,
.markdown-body ol.no-list {
	padding: 0;
	list-style-type: none;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
	margin-top: 0;
	margin-bottom: 0;
}

.markdown-body li>p {
	margin-top: 16px;
}

.markdown-body dl {
	padding: 0;
}

.markdown-body dl dt {
	padding: 0;
	margin-top: 16px;
	font-size: 1em;
	font-style: italic;
	font-weight: bold;
}

.markdown-body dl dd {
	padding: 0 16px;
	margin-bottom: 16px;
}

.markdown-body blockquote {
	padding: 0 15px;
	color: #777;
	border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
	margin-top: 0;
}

.markdown-body blockquote>:last-child {
	margin-bottom: 0;
}

.markdown-body table {
	display: block;
	width: 100%;
	overflow: auto;
	word-break: normal;
	word-break: keep-all;
}

.markdown-body table th {
	font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
	padding: 6px 13px;
	border: 1px solid #ddd;
}

.markdown-body table tr {
	background-color: #fff;
	border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
	background-color: #f8f8f8;
}

.markdown-body img {
	max-width: 100%;
	-moz-box-sizing: border-box;
	box-sizing: border-box;
}

.markdown-body span.frame {
	display: block;
	overflow: hidden;
}

.markdown-body span.frame>span {
	display: block;
	float: left;
	width: auto;
	padding: 7px;
	margin: 13px 0 0;
	overflow: hidden;
	border: 1px solid #ddd;
}

.markdown-body span.frame span img {
	display: block;
	float: left;
}

.markdown-body span.frame span span {
	display: block;
	padding: 5px 0 0;
	clear: both;
	color: #333;
}

.markdown-body span.align-center {
	display: block;
	overflow: hidden;
	clear: both;
}

.markdown-body span.align-center>span {
	display: block;
	margin: 13px auto 0;
	overflow: hidden;
	text-align: center;
}

.markdown-body span.align-center span img {
	margin: 0 auto;
	text-align: center;
}

.markdown-body span.align-right {
	display: block;
	overflow: hidden;
	clear: both;
}

.markdown-body span.align-right>span {
	display: block;
	margin: 13px 0 0;
	overflow: hidden;
	text-align: right;
}

.markdown-body span.align-right span img {
	margin: 0;
	text-align: right;
}

.markdown-body span.float-left {
	display: block;
	float: left;
	margin-right: 13px;
	overflow: hidden;
}

.markdown-body span.float-left span {
	margin: 13px 0 0;
}

.markdown-body span.float-right {
	display: block;
	float: right;
	margin-left: 13px;
	overflow: hidden;
}

.markdown-body span.float-right>span {
	display: block;
	margin: 13px auto 0;
	overflow: hidden;
	text-align: right;
}

.markdown-body code,.markdown-body tt {
	padding: 0;
	padding-top: 0.2em;
	padding-bottom: 0.2em;
	margin: 0;
	font-size: 85%;
	background-color: rgba(0,0,0,0.04);
	border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after,
.markdown-body tt:before,
.markdown-body tt:after {
	letter-spacing: -0.2em;
	content: "\00a0";
}

.markdown-body code br,
.markdown-body tt br {
	display: none;
}

.markdown-body del code {
	text-decoration: inherit;
}

.markdown-body pre>code {
	padding: 0;
	margin: 0;
	font-size: 100%;
	word-break: normal;
	white-space: pre;
	background: transparent;
	border: 0;
}

.markdown-body .highlight {
	margin-bottom: 16px;
}

.markdown-body .highlight pre,
.markdown-body pre {
	padding: 16px;
	overflow: auto;
	font-size: 85%;
	line-height: 1.45;
	background-color: #f7f7f7;
	border-radius: 3px;
}

.markdown-body .highlight pre {
	margin-bottom: 0;
	word-break: normal;
}

.markdown-body pre {
	word-wrap: normal;
}

.markdown-body pre code,
.markdown-body pre tt {
	display: inline;
	max-width: initial;
	padding: 0;
	margin: 0;
	overflow: initial;
	line-height: inherit;
	word-wrap: normal;
	background-color: transparent;
	border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after,
.markdown-body pre tt:before,
.markdown-body pre tt:after {
	content: normal;
}

.highlight .pl-coc,
.highlight .pl-entl,
.highlight .pl-entm,
.highlight .pl-eoa,
.highlight .pl-mai .pl-sf,
.highlight .pl-mm,
.highlight .pl-pdv,
.highlight .pl-sc,
.highlight .pl-som,
.highlight .pl-sr,
.highlight .pl-v,
.highlight .pl-vpf {
	color: #0086b3;
}
.highlight .pl-eoac,
.highlight .pl-mdht,
.highlight .pl-mi1,
.highlight .pl-mri,
.highlight .pl-va,
.highlight .pl-vpu {
	color: #008080;
}
.highlight .pl-c,
.highlight .pl-pdc {
	color: #b4b7b4;
	font-style: italic;
}
.highlight .pl-k,
.highlight .pl-ko,
.highlight .pl-kolp,
.highlight .pl-mc,
.highlight .pl-mr,
.highlight .pl-ms,
.highlight .pl-s,
.highlight .pl-sok,
.highlight .pl-st {
	color: #6e5494;
}
.highlight .pl-ef,
.highlight .pl-enf,
.highlight .pl-enm,
.highlight .pl-entc,
.highlight .pl-eoi,
.highlight .pl-sf,
.highlight .pl-smc {
	color: #d12089;
}
.highlight .pl-ens,
.highlight .pl-eoai,
.highlight .pl-kos,
.highlight .pl-mh .pl-pdh,
.highlight .pl-mp,
.highlight .pl-pde,
.highlight .pl-stp {
	color: #458;
}
.highlight .pl-enti {
	color: #d12089;
	font-weight: bold;
}
.highlight .pl-cce,
.highlight .pl-enc,
.highlight .pl-kou,
.highlight .pl-mq {
	color: #f93;
}
.highlight .pl-mp1 .pl-sf {
	color: #458;
	font-weight: bold;
}
.highlight .pl-cos,
.highlight .pl-ent,
.highlight .pl-md,
.highlight .pl-mdhf,
.highlight .pl-ml,
.highlight .pl-pdc1,
.highlight .pl-pds,
.highlight .pl-s1,
.highlight .pl-scp,
.highlight .pl-sol {
	color: #df5000;
}
.highlight .pl-c1,
.highlight .pl-cn,
.highlight .pl-pse,
.highlight .pl-pse .pl-s2,
.highlight .pl-vi {
	color: #a31515;
}
.highlight .pl-mb,
.highlight .pl-pdb {
	color: #df5000;
	font-weight: bold;
}
.highlight .pl-mi,
.highlight .pl-pdi {
	color: #6e5494;
	font-style: italic;
}
.highlight .pl-ms1 {
	background-color: #f5f5f5;
}
.highlight .pl-mdh,
.highlight .pl-mdi {
	font-weight: bold;
}
.highlight .pl-mdr {
	color: #0086b3;
	font-weight: bold;
}
.highlight .pl-s2 {
	color: #333;
}
.highlight .pl-ii {
	background-color: #df5000;
	color: #fff;
}
.highlight .pl-ib {
	background-color: #f93;
}
.highlight .pl-id {
	background-color: #a31515;
	color: #fff;
}
.highlight .pl-iu {
	background-color: #b4b7b4;
}
.highlight .pl-mo {
	color: #969896;
}

</style>


<script type="text/javascript">

function getDocumentScrollTop() 
{
   var res = document.body.scrollTop || document.documentElement.scrollTop || window.pageYOffset || 0;
   // alert(res);
   return res;
}

function setDocumentScrollTop(ypos) 
{
	window.scrollTo(0, ypos);
}

</script>


</head>
<body class="markdown-body">
<h1> <a id="iml-to-smt-generator-output" class="anchor" href="#iml-to-smt-generator-output" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>IML to SMT Generator: Output</h1> 
<p>The SMT generator of HERMES emits SMT encoding, which mostly conforms to <a href="http://smtlib.cs.uiowa.edu/papers/smt-lib-reference-v2.6-r2017-07-18.pdf" rel="nofollow">The SMT-LIB Standard/Language Version 2.6</a>. Please following the link for details. In the following, we briefly touch upon some basics to facilitate our discussion.</p> 
<p>The SMT-LIB Language consists of theory declarations, logic declarations and scripts. The language syntax is similar to that of the LISP Programming Language and an expression of the SMT-LIB Language is a Common-Lisp S-expressions. An S-expression is either a non-parenthesis token or a sequence (possibly empty) of S-expressions enclosed in parenthesis. In the SMT-LIB Language, logic expressions are represented with well-sorted terms. Besides built-in sorts (e.g. <code>Bool</code>, <code>Int</code>, <code>Real</code>, etc.), new sorts can be introduced as follows:</p> 
<pre><code>(declare-sort s n)
</code></pre> 
<p>The above declaration adds sort symbol <code>s</code> with associated arity <code>n</code>.</p> 
<p>Similarly new functions can be introduced as follows:</p> 
<pre><code>(declare-fun f (σ_1 &middot;&middot;&middot; σ_n) σ)
</code></pre> 
<p>The above declaration adds a new function symbol <code>f</code> with associated rank <code>σ_1 &middot;&middot;&middot; σ_nσ</code> with <code>n ≥ 0</code>.</p> 
<p>Datatypes can be introduced as follows:</p> 
<pre><code>(declare-datatypes ((D_1 k_1) &middot;&middot;&middot; (D_n k_n)) (d_1 &middot;&middot;&middot; d_n))
</code></pre> 
<p>The above declaration brings in <code>n</code> algebraic datatypes <code>D_1, ..., D_n</code> with respective arities <code>k_1, ..., k_n</code> and declarations <code>d_1, ..., d_n</code>.</p> 
<p>Note that our SMT-encoding introduces enumeration datatypes <code>declare-datatypes</code>. The above format works for solvers like CVC4. Unfortunately this format doesn't work for Z3 and we need to use its corresponding required format when targeting the Z3 solver.</p> 
<p>Assertions are added as follows:</p> 
<pre><code>(assert t)
</code></pre> 
<p>The above command add <code>t</code>, a well-sorted term of sort <code>Bool</code> to its current assertion level.</p> 
<p>The SMT-LIB Language supports comments in the following style:</p> 
<pre><code>; char sequence not contained within a string literal or a quoted symbol starting with &quot;;&quot; and ending with the first subsequent line breaking char
</code></pre> 
<p>The following code segments are the SMT-encoding for the example shown in Section <a href="./.gen_smt_input.md.html">IML to SMT Generator: Input</a>.</p> 
<p><a href="../fig/smtEncodingSort.png" target="_blank" rel="noopener noreferrer"><img src="../fig/smtEncodingSort.png" alt="example smtEncodingSort" style="max-width:100%;" /></a></p> 
<p>The above code segment (from Line 01 to 11) illustrates the sorts and datatype generated for the example. The <code>OutDataPort&lt;Int&gt;</code> type used in Lines 07, 16, 26, 33, 46, 48, 50 and 52 of the example is encoded with the sort introduced in Line 01 of the above code segment. The <code>InDataPort&lt;Int&gt;</code> type used in Lines 06, 15, 24, 25, 32, 44, 46, 48 and 50 of the example is encoded with the sort introduced in Line 08 of the above code segment. The <code>Connector&lt;InDataPort&lt;Int&gt;, InDataPort&lt;Int&gt;&gt;</code> type used in Line 44, the <code>Connector&lt;OutDataPort&lt;Int&gt;, InDataPort&lt;Int&gt;&gt;</code> type used in Lines 46, 48 and 50, and the <code>Connector&lt;OutDataPort&lt;Int&gt;, OutDataPort&lt;Int&gt;&gt;</code> type used in Line 52 of the example are respectively encoded with the sorts introduces in Lines 09, 02 and 03 of the above code segment. Constrained types <code>A</code> (defined in Line 13 of the example), <code>B</code> (defined in Line 22 of the example) and <code>C</code> (defined in Line 30 of the example) are respectively encoded with the sorts introduced in Lines 06, 05 and 07 of the above code segment. The constrained type <code>top_level</code> (defined in Line 39 of the example) and <code>top_level_dot_Impl</code> (defined in Line 40 of the example) are encoded with the sorts introduced in Lines 11 and 04 of the above code segment, respectively. Lastly the enumeration type <code>Direction</code> defined in package <code>iml.systems</code> is encoded with datatype introduced in Line 10 of the above code segment.</p> 
<p><a href="../fig/smtEncodingFunction.png" target="_blank" rel="noopener noreferrer"><img src="../fig/smtEncodingFunction.png" alt="example smtEncodingFinction2" style="max-width:100%;" /></a></p> 
<p>The above code segment illustrates new function symbols introduced for the example. The functions introduced in Lines 12, 13 and 14 of the above code segment respectively encode variables <code>A_sub</code>, <code>B_sub</code> and <code>C_sub</code> in Lines 41-43 in the example. The functions introduced in Lines 19, 20, 28 and 59 of the above code segment respectively encode variables <code>Input</code> of Lines 32, 06, 15 and 32 of the example. The functions introduced in Lines 31 and 34 of the above code segment respectively encode variables <code>Input1</code> of Line 24 and <code>Input2</code> of Line 25 of the example. The functions introduced in Lines 27, 33, 40, 41 and 60 of the above code segment respectively encode variables <code>Output</code> of Lines 07, 16, 26, 33 and 33 of the example. The functions introduced in Lines 43, 44, 47, 48, 51, 52, 56, 61 and 62 respectively encode the requirements of Lines 34, 35, 17, 18, 08, 09, 27, 34 and 35 of the example. The functions introduced in Lines 45, 46, 49, 50, 53, 54, 57, 63 and 64 respectively encode the assumptions/guarantees of Lines 36, 37, 19, 20, 10, 11, 28, 36 and 37 of the example.</p> 
<p>The functions introduced in Lines 21, 29, 32, 35 and 42 of the above code segment respectively encode variables <code>IN_TO_A</code> of Line 44, <code>A_TO_B</code> of Line 46, <code>A_TO_C</code> of Line 48, <code>B_TO_C</code> of Line 50 and <code>C_TO_Output</code> of Line 52 of the example. The functions introduced in Lines 16 and 17 of the above code segment respectively encode variables <code>source</code> and <code>target</code> of type <code>Connector&lt;InDataPort&lt;Int&gt;, InDataPort&lt;Int&gt;&gt;</code> used in Line 44 of the example. The functions introduced in Lines 24 and 25 of the above code segment respectively encode variables <code>source</code> and <code>target</code> of type <code>Connector&lt;OutDataPort&lt;Int&gt;, InDataPort&lt;Int&gt;&gt;</code> used in Lines 44, 48 and 50 of the example. The functions introduced in Lines 37 and 38 of the above code segment respectively encode variables <code>source</code> and <code>target</code> of type <code>Connector&lt;OutDataPort&lt;Int&gt;, OutDataPort&lt;Int&gt;&gt;</code> used in Line 52 of the example. The functions introduced in Lines 18, 26 and 39 of the above code segment respectively encode <code>connect&lt;InDataPort&lt;Int&gt;, InDataPort&lt;Int&gt;&gt;</code> (in Line 44 of the example), <code>connect&lt;OutDataPort&lt;Int&gt;, InDataPort&lt;Int&gt;&gt;</code> (in Lines 46, 48 and 50) and <code>connect&lt;OutDataPort&lt;Int&gt;, OutDataPort&lt;Int&gt;&gt;</code> (in Line 52 of the example), whose <code>some</code> constructors are respectively encoded by the functions introduced in Lines 15, 23 and 36 of the above code segment. The functions introduced in Lines 22 and 30 of the above code segment respectively encode variables <code>data</code> of the instantiation of types <code>InDataPort&lt;DataType&gt;</code> and <code>OutDataPort&lt;DataType&gt;</code> exhibiting trait <code>DataCarrier&lt;DataType&gt;</code> with <code>DataType</code> to be <code>Int</code> as defined in package <code>iml.systms</code>. The functions introduced in Lines 55 and 58 of the above code segment respectively encode variables <code>direction</code> of the instantiation of type <code>OutDataPort&lt;DataType&gt;</code> and <code>InDataPort&lt;DataType&gt;</code> exhibiting trait <code>Port</code> with <code>DataType</code> to be <code>Int</code> as defined in package <code>iml.systems</code>.</p> 
<p><a href="../fig/smtEncodingAssert.png" target="_blank" rel="noopener noreferrer"><img src="../fig/smtEncodingAssert.png" alt="example smtEncodingAssert" style="max-width:100%;" /></a></p> 
<p>The above code segment illustrate the assertion section generated for the example. The asserts of Lines 65, 66, 67, 68 and 74 enforce the data along the connections stay unchanged, which respectively correspond to Lines 47, 51, 45, 53 and 49. The asserts of Lines 69 and 73 respectively enforce the directions of <code>OutPort</code> and <code>InPort</code>, as prescribed for traits <code>Out</code> and <code>In</code> in package <code>iml.systems</code>. The asserts of Lines 70, 71 and 72 enforce that the respective <code>source</code> and <code>target</code> are equal to their counterpart when two connectors are connected via <code>connect</code>.</p> 
<p>Notice that fully-qualified names are used to guarantee unique identifiers in the encoding.</p>
</body>
</html>
